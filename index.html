<!DOCTYPE html>

<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detective Memo Fox Number Mystery</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #f5f5dc 0%, #e6d7b7 50%, #d4c5a9 100%);
            text-align: center;
            padding: 20px;
            font-size: 18px;
            margin: 0;
            min-height: 100vh;
        }
        .container {
            background: linear-gradient(135deg, #f5f5dc 0%, #f0ead6 100%);
            padding: 40px;
            border-radius: 20px;
            max-width: 600px;
            margin: 20px auto;
            box-shadow: 0 8px 24px rgba(0,0,0,0.2);
        }
        h1 {
            color: #228B22;
            font-size: 3.5em;
            margin: 30px 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        .fox {
            font-size: 10em;
            margin: 30px 0;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.2);
        }
        .fox-small {
            font-size: 3em;
            margin: 0;
        }
        .intro {
            font-size: 2.5em;
            color: #228B22;
            margin: 35px 0;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        button {
            background: linear-gradient(135deg, #ff6b6b 0%, #ff8e53 100%);
            color: white;
            border: none;
            padding: 25px 35px;
            font-size: 1.8em;
            border-radius: 50px;
            cursor: pointer;
            margin: 20px;
            font-weight: bold;
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }
        .continue-btn {
            background: linear-gradient(135deg, #32CD32 0%, #228B22 100%);
            font-size: 1.4em;
            padding: 18px 35px;
        }
        input {
            padding: 18px;
            font-size: 1.4em;
            border: 3px solid #4ecdc4;
            border-radius: 10px;
            width: 250px;
            text-align: center;
            margin: 20px;
            background: white;
            font-weight: bold;
        }
        .answer-input {
            width: 180px;
            font-size: 1.3em;
            color: #228B22;
        }
        .section {
            margin: 30px 0;
            padding: 25px;
            background: rgba(255,255,255,0.4);
            border-radius: 15px;
            border: 3px solid #4ecdc4;
        }
        .directions {
            font-size: 1.4em;
            color: #228B22;
            margin: 20px 0;
            font-weight: bold;
        }
        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .longest-streak {
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
            color: #333;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 0.9em;
            font-weight: bold;
            margin-top: 5px;
        }
        .streak-info {
            background: linear-gradient(135deg, #ff6b6b 0%, #ff8e53 100%);
            color: white;
            padding: 12px 18px;
            border-radius: 12px;
            margin: 15px 0;
            font-size: 1.1em;
            font-weight: bold;
        }
        .timer-display {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
            padding: 10px 18px;
            border-radius: 20px;
            font-size: 1.5em;
            font-weight: bold;
            margin: 15px 0;
        }
        .number-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin: 25px auto;
            max-width: 350px;
            min-height: 160px;
        }
        .grid-5 { grid-template-columns: repeat(5, 1fr); max-width: 400px; }
        .grid-6 { grid-template-columns: repeat(3, 1fr); max-width: 300px; }
        .grid-7 { grid-template-columns: repeat(4, 1fr); max-width: 400px; }
        .grid-8 { grid-template-columns: repeat(4, 1fr); max-width: 400px; }
        .number-box {
            width: 70px;
            height: 70px;
            border: 3px solid #4ecdc4;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.2em;
            font-weight: bold;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        .missing-number {
            background: linear-gradient(135deg, #32CD32 0%, #228B22 100%);
            font-size: 2.8em;
        }
        .hidden-numbers {
            opacity: 0;
        }
        .feedback {
            font-size: 1.4em;
            font-weight: bold;
            margin: 20px 0;
            padding: 15px;
            border-radius: 12px;
            min-height: 25px;
        }
        .success {
            background: #d4edda;
            color: #228B22;
            border: 3px solid #c3e6cb;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 3px solid #f5c6cb;
        }
        .hidden { display: none; }
        @media (max-width: 600px) {
            h1 { font-size: 2.5em; }
            .fox { font-size: 7em; }
            button { font-size: 1.4em; padding: 20px 30px; }
            .intro { font-size: 2em; }
            .game-header { flex-direction: column; gap: 10px; }
        }
    </style>
</head>
<body>

<!-- Welcome Screen -->

<div id="welcome">
    <div class="container">
        <h1>üéØ Detective Number Mystery</h1>
        <div class="fox">ü¶äüîç</div>
        <div class="intro">Hi! I'm Memo the Fox!</div>
        <button type="button" onclick="startIntro()">üîä Meet Memo!</button>
    </div>
</div>

<!-- Name Entry -->

<div id="name-screen" class="hidden">
    <div class="container">
        <h1>üéØ Detective Number Mystery</h1>
        <div class="fox">ü¶äüîç</div>
        <div class="section">
            <div class="directions">What's your name, detective?</div>
            <input type="text" id="nameField" placeholder="Enter your name" maxlength="15">
            <br>
            <button class="continue-btn" type="button" onclick="processName()">Next</button>
        </div>
    </div>
</div>

<!-- Game Screen -->

<div id="game-screen" class="hidden">
    <div class="container">
        <div class="game-header">
            <h1 style="margin: 0; font-size: 1.8em; color: #228B22;">üéØ Level 1: Numbers 1-4</h1>
            <div>
                <div class="fox-small">ü¶äüîç</div>
                <div class="longest-streak">LONGEST: <span id="longest-streak">0</span></div>
            </div>
        </div>

```
    <div class="streak-info" id="streak-display">
        STREAK: 0 | MISSION: Get 5 in a row!
    </div>

    <div class="directions">
        Numbers 1 through 4 below, some are missing:
    </div>

    <div class="timer-display hidden" id="timer-display"></div>

    <div class="number-grid" id="number-grid"></div>

    <div class="directions hidden" id="input-prompt">
        Enter missing numbers (space between):
    </div>

    <div id="input-section" class="hidden">
        <input type="text" class="answer-input" id="answer-input" autocomplete="off">
        <button class="continue-btn" type="button" onclick="checkAnswer()">Submit</button>
    </div>

    <button class="continue-btn hidden" id="try-again-btn" type="button" onclick="showNumbersAgain()">Try Again (Show Numbers)</button>
    <button class="continue-btn hidden" id="next-round-btn" type="button" onclick="nextRound()">Next Round</button>

    <div class="feedback" id="feedback"></div>
</div>
```

</div>

<script>
// Game state
var playerName = '';
var consecutiveCorrect = 0;
var longestStreak = 0;
var currentMissing = [];
var numbersVisible = true;
var gameTimer = null;
var inputEnabled = false;

function speak(text, callback) {
    if (window.speechSynthesis) {
        try {
            speechSynthesis.cancel();
            var utterance = new SpeechSynthesisUtterance(text);
            utterance.rate = 0.9;
            utterance.pitch = 1.1;
            utterance.volume = 0.8;
            if (callback) utterance.onend = callback;
            speechSynthesis.speak(utterance);
        } catch (e) {
            if (callback) callback();
        }
    } else if (callback) {
        callback();
    }
}

function shuffle(array) {
    var result = array.slice();
    for (var i = result.length - 1; i > 0; i--) {
        var j = Math.floor(Math.random() * (i + 1));
        var temp = result[i];
        result[i] = result[j];
        result[j] = temp;
    }
    return result;
}

function showScreen(screenId) {
    document.getElementById('welcome').style.display = 'none';
    document.getElementById('name-screen').style.display = 'none';
    document.getElementById('game-screen').style.display = 'none';
    document.getElementById(screenId).style.display = 'block';
}

function startIntro() {
    speak("Hello young detective! I'm Memo the Fox, and I need your help solving number mysteries! Please enter your name so we can get started!");
    setTimeout(function() {
        showScreen('name-screen');
        setTimeout(function() {
            document.getElementById('nameField').focus();
        }, 500);
    }, 8000);
}

function processName() {
    var nameInput = document.getElementById('nameField');
    playerName = nameInput.value.trim();
    
    if (!playerName) {
        speak('Please enter your name first!');
        nameInput.focus();
        return;
    }
    
    showScreen('game-screen');
    speak('Hello ' + playerName + '! Let\'s start our mystery! Your mission is to find 5 missing numbers in a row!');
    setTimeout(createNewRound, 3000);
}

function updateStreak() {
    if (consecutiveCorrect > longestStreak) {
        longestStreak = consecutiveCorrect;
        document.getElementById('longest-streak').textContent = longestStreak;
    }
    
    var display = document.getElementById('streak-display');
    if (consecutiveCorrect >= 5) {
        display.textContent = 'STREAK: ' + consecutiveCorrect + ' | üéâ MISSION COMPLETE!';
        display.style.background = 'linear-gradient(135deg, #32CD32 0%, #228B22 100%)';
    } else {
        var needed = 5 - consecutiveCorrect;
        display.textContent = 'STREAK: ' + consecutiveCorrect + ' | MISSION: Get ' + needed + ' more!';
        display.style.background = 'linear-gradient(135deg, #ff6b6b 0%, #ff8e53 100%)';
    }
}

function enableInput() {
    document.getElementById('input-prompt').style.display = 'block';
    document.getElementById('input-section').style.display = 'block';
    var input = document.getElementById('answer-input');
    inputEnabled = true;
    input.disabled = false;
    input.focus();
}

function disableInput() {
    document.getElementById('input-prompt').style.display = 'none';
    document.getElementById('input-section').style.display = 'none';
    var input = document.getElementById('answer-input');
    inputEnabled = false;
    input.disabled = true;
}

function startTimer() {
    var timerDisplay = document.getElementById('timer-display');
    timerDisplay.style.display = 'block';
    var timeLeft = 15; // 15 seconds
    timerDisplay.textContent = 'Time left: ' + timeLeft + 's';
    
    gameTimer = setInterval(function() {
        timeLeft--;
        timerDisplay.textContent = 'Time left: ' + timeLeft + 's';
        
        if (timeLeft <= 0) {
            clearInterval(gameTimer);
            hideNumbers();
        }
    }, 1000);
}

function hideNumbers() {
    var grid = document.getElementById('number-grid');
    grid.className = grid.className + ' hidden-numbers';
    document.getElementById('timer-display').style.display = 'none';
    document.getElementById('try-again-btn').style.display = 'block';
    numbersVisible = false;
    
    speak('OK ' + playerName + ', time\'s up! Now enter the missing numbers from your memory.', enableInput);
}

function showNumbersAgain() {
    var grid = document.getElementById('number-grid');
    grid.className = grid.className.replace(' hidden-numbers', '');
    document.getElementById('try-again-btn').style.display = 'none';
    numbersVisible = true;
    disableInput();
    
    if (gameTimer) clearInterval(gameTimer);
    speak(playerName + ', here are the numbers again. Study them carefully!', startTimer);
}

function createNewRound() {
    var numbers = [1, 2, 3, 4];
    var shuffled = shuffle(numbers);
    var missingPositions = [];
    
    // Pick 2 random positions to hide
    while (missingPositions.length < 2) {
        var pos = Math.floor(Math.random() * 4);
        if (missingPositions.indexOf(pos) === -1) {
            missingPositions.push(pos);
        }
    }
    
    currentMissing = [];
    for (var i = 0; i < missingPositions.length; i++) {
        currentMissing.push(shuffled[missingPositions[i]]);
    }
    currentMissing.sort(function(a, b) { return a - b; });
    
    // Create grid
    var grid = document.getElementById('number-grid');
    grid.innerHTML = '';
    grid.className = 'number-grid';
    
    for (var i = 0; i < shuffled.length; i++) {
        var box = document.createElement('div');
        box.className = 'number-box';
        
        if (missingPositions.indexOf(i) !== -1) {
            box.className += ' missing-number';
            box.textContent = '?';
        } else {
            box.textContent = shuffled[i];
        }
        
        grid.appendChild(box);
    }
    
    // Reset UI
    numbersVisible = true;
    disableInput();
    document.getElementById('answer-input').value = '';
    document.getElementById('feedback').textContent = '';
    document.getElementById('try-again-btn').style.display = 'none';
    document.getElementById('next-round-btn').style.display = 'none';
    document.getElementById('timer-display').style.display = 'none';
    
    if (gameTimer) clearInterval(gameTimer);
    updateStreak();
    
    var visible = [];
    for (var i = 0; i < shuffled.length; i++) {
        if (missingPositions.indexOf(i) === -1) {
            visible.push(shuffled[i]);
        }
    }
    
    var speech = playerName + ', I can see the numbers ' + visible.join(', ') + ', but 2 numbers are missing. Study them carefully!';
    speak(speech, startTimer);
}

function checkAnswer() {
    if (!inputEnabled) return;
    
    var input = document.getElementById('answer-input');
    var answer = input.value.trim();
    var feedback = document.getElementById('feedback');
    
    if (!answer) {
        feedback.textContent = 'Please enter your answer!';
        feedback.className = 'feedback error';
        speak('Please enter your answer!');
        return;
    }
    
    var userNumbers = [];
    var parts = answer.split(/\s+/);
    for (var i = 0; i < parts.length; i++) {
        var num = parseInt(parts[i]);
        if (!isNaN(num)) {
            userNumbers.push(num);
        }
    }
    
    userNumbers.sort(function(a, b) { return a - b; });
    var isCorrect = true;
    if (userNumbers.length !== currentMissing.length) {
        isCorrect = false;
    } else {
        for (var i = 0; i < userNumbers.length; i++) {
            if (userNumbers[i] !== currentMissing[i]) {
                isCorrect = false;
                break;
            }
        }
    }
    
    if (gameTimer) clearInterval(gameTimer);
    document.getElementById('timer-display').style.display = 'none';
    document.getElementById('try-again-btn').style.display = 'none';
    disableInput();
    
    if (isCorrect) {
        consecutiveCorrect++;
        var celebrations = ['Great job!', 'Excellent!', 'Awesome!', 'Perfect!'];
        var celebration = celebrations[Math.floor(Math.random() * celebrations.length)];
        
        feedback.textContent = celebration + ' That\'s ' + consecutiveCorrect + ' in a row!';
        feedback.className = 'feedback success';
        speak(celebration + ' ' + playerName + '! That\'s ' + consecutiveCorrect + ' in a row!');
        
        document.getElementById('next-round-btn').style.display = 'block';
    } else {
        consecutiveCorrect = 0;
        feedback.textContent = 'The missing numbers were ' + currentMissing.join(' and ') + '. Let\'s try again!';
        feedback.className = 'feedback error';
        speak('The missing numbers were ' + currentMissing.join(' and ') + '. Let\'s try another one!');
        
        document.getElementById('next-round-btn').style.display = 'block';
    }
    
    updateStreak();
}

function nextRound() {
    createNewRound();
}
</script>

</body>
</html>
